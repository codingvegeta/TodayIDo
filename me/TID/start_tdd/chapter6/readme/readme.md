# 테스트 코드의 구성

---
## 기능에서의 상황

* 결과에 영향을 줄 수 있는 상황을 고려하지 않고 작성한 코드는 버그를 포함할 가능성이 크다.
* 다양한 에외 상황을 찾아내고 이를 코드에 반영해야 기능이 비정상 적으로 동작하는 것을 막을 수 있다.
* 결과에 악영향을 줄 수 있는 모든 상황을 완벽하게 찾기 힘들 수도 있지만 가능한 많은 예외 상황을
찾기 위해 노력해야 한다.
* 그렇게 해야 소프트웨어 품질을 높일 수 있다.

## 테스트의 구성 요소 : 상황, 실행, 결과 확인

* 어떤 상황이 주어지고, 그 상황에서 기능을 실행하고, 실행한 결과를 확인하는 세가지가
테스트 코드의 기본 골격을 이루게 된다.
* JUnit에서 상황을 설정하는 방법은 테스트할 대상에 따라 달라진다.
* 상황이 없는 경우도 존재한다.
* 실행 결과를 확인하는 쉬운 방법은 리턴값을 사용하는 것이다.
* 실행 결과가 항상 리턴 값으로 존재하는 것은 아니다.
* 실행 결과로 익셉션을 발생하는 것이 정상인 경우도 있다.

### 읽어보기
    상황-실행-결과 확인 구조에 너무 집착하지 말자.
    이 구조가 테스트 코드를 작성하는데 도움이 되는것은 맞지만 꼭 모든 테스트를
    이 구조로 만들어야 하는것은 아니다.

## 외부 상태가 테스트 결과에 영향을 주지 않게 하기

* 테스트 코드는 한 번만 실행하고 끝나지 않는다.
* TDD를 진행하는 동안에도 계속 실행하고 개발이 끝난 이후에도 반복적으로 테스트를
실행해서 문제가 없는지 검증한다.
* 테스트는 언제 실행해도 항상 정삭적으로 동작하는 것이 중요하다.
* 외부 상태에 따라 테스트의 성공 여부가 바뀌지 않으려면 테스트 실행 전에 외부를 원하는
상태로 만들거나 테스트 실행 후에 외부 상태를 원래대로 되돌려 놓아야 한다.

## 외부 상태와 테스트 어려움

* 테스트 대상이 아닌 외부 요인은 테스트 코드에서 다루기 힘든 존재다.
* 외부 상황은 테스트 코드에서 마음대로 제어할 수 없는 경우가 있다.
* 테스트 코드에서 생성한 외부 결과를 마음대로 초기화하기 힘들 때도 있다.
* 테스트 대상의 상황과 결과에 외부 요인이 관여할 경우 대역을 사용하면 테스트 작성이 쉬워진다.
* 대역은 테스트 대상이 의존하는 대상의 실제 구현을 대신하는 구현인데 이 대역을 통해서
외부 상황이나 결과를 대체할 수 있다.
